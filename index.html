<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Watermark-It - The Easy Tool For Property Photos</title>
  <meta name="description" content="Professional real estate image watermarking tool with live preview, batch processing, and ARMLS compliance by Fort Lowell Realty & Property Management.">
  <meta name="keywords" content="watermark, real estate, image processing, Fort Lowell Realty, property photos, batch processing, ARMLS">

  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Watermark-It">
  <meta property="og:description" content="Brand your real estate images with Fort Lowell Realty watermarks. Professional batch processing with live preview.">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://pfst.cf2.poecdn.net/base/image/6d5c1c170575ce0a42988a32013449025819fe5c5d775f22ed0a42043e4d5768?w=1200&h=630">

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- Styles -->
  <link rel="stylesheet" href="style/styles.css">

  <!-- External Libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.4/dist/heic2any.min.js"></script>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://pfst.cf2.poecdn.net/base/image/57c851c04753092259d83d0a1aa34e2fd889c7218b50a338e6100dbf21ae922c?w=32&h=32">
</head>
<body>
  <!-- Toast Container -->
  <div id="toast-container" class="toast-container"></div>

  <!-- Processing Overlay -->
  <div id="processing-overlay" class="processing-overlay">
    <div class="processing-box">
      <div class="processing-spinner"><i class="fas fa-circle-notch fa-spin"></i></div>
      <div class="processing-text">Importing... please wait</div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="logo-container">
        <img src="https://pfst.cf2.poecdn.net/base/image/57c851c04753092259d83d0a1aa34e2fd889c7218b50a338e6100dbf21ae922c?w=733&h=982"
             alt="Fort Lowell Realty Logo"
             class="company-logo"
             loading="eager">
        <div class="brand-text">
          <h1>Watermark-It</h1>
          <span class="brand-subtitle"><strong>Fortify Your Investment</strong></span>
        </div>
      </div>
      <div class="nav-actions">
        <button class="nav-btn" id="help-btn" title="How to use Watermark-It">
          <i class="fas fa-question-circle"></i>
          <span>Help</span>
        </button>
      </div>
    </div>
  </nav>

  <!-- Compact Hero -->
  <section class="hero-compact">
    <div class="hero-content-compact">
      <h2>Professional Property Image Watermarking</h2>
      <p>Upload images, select a watermark, preview &amp; download. Supports JPG, PNG, WebP, HEIC, and ZIP.</p>
    </div>
  </section>

  <!-- ARMLS Toggle Banner -->
  <div class="armls-banner">
    <div class="armls-toggle-card" id="armls-card">
      <div class="armls-left">
        <div class="armls-icon"><i class="fas fa-gavel"></i></div>
        <div class="armls-label-text">
          <h4>ARMLS Compliance Mode</h4>
          <p>Restricts to ARMLS-approved watermarks only. Disables custom branding &amp; custom uploads.</p>
        </div>
      </div>
      <div class="armls-right">
        <span class="armls-status" id="armls-status">OFF</span>
        <label class="switch">
          <input type="checkbox" id="mls-toggle">
          <span class="slider-round"></span>
        </label>
      </div>
    </div>
  </div>

  <!-- Main Application -->
  <main class="main-container">
    <div class="content-grid">

      <!-- ====== LEFT PANEL ====== -->
      <div class="left-panel">

        <!-- File Upload Card -->
        <div class="card upload-card">
          <div class="card-header">
            <h3>
              <i class="fas fa-cloud-upload-alt"></i>
              <span class="step-label">Step 1:</span> Upload Property Images
            </h3>
            <div class="file-counter"><span id="file-count">0</span> files</div>
          </div>
          <div class="card-body">
            <!-- Upload method tabs -->
            <div class="upload-methods">
              <button class="upload-method-btn active" data-method="files" id="files-tab">
                <i class="fas fa-folder"></i> Files/ZIP
              </button>
              <button class="upload-method-btn" data-method="url" id="url-tab">
                <i class="fas fa-link"></i> Image URLs
              </button>
            </div>

            <!-- File upload -->
            <div id="files-upload" class="upload-section">
              <div id="drop-zone" class="drop-zone">
                <div class="drop-zone-content">
                  <div class="drop-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                  <h4>Drag &amp; Drop Images Here</h4>
                  <p>or click to browse files</p>
                  <div class="file-types">
                    <span class="file-type">JPG</span>
                    <span class="file-type">PNG</span>
                    <span class="file-type heic-supported">HEIC</span>
                    <span class="file-type">WebP</span>
                    <span class="file-type">ZIP</span>
                  </div>
                </div>
                <input type="file" id="file-input" accept=".jpg,.jpeg,.png,.webp,.heic,.heif,.zip" multiple hidden>
              </div>
            </div>

            <!-- URL upload -->
            <div id="url-upload" class="upload-section" style="display: none;">
              <div class="url-input-container">
                <textarea id="image-url-input"
                          placeholder="Enter image URLs (one per line)&#10;https://example.com/photo1.jpg&#10;https://example.com/photo2.png"
                          class="url-textarea"
                          rows="3"></textarea>
                <button id="add-url-btn" class="btn btn-primary">
                  <i class="fas fa-plus"></i> Add URLs
                </button>
              </div>
            </div>

            <!-- File list -->
            <div id="file-list" class="file-list"></div>
          </div>
        </div>

        <!-- Download Card -->
        <div class="card process-card">
          <div class="card-header">
            <h3>
              <i class="fas fa-download"></i>
              <span class="step-label">Step 3:</span> Download
            </h3>
          </div>
          <div class="process-content">
            <div class="process-info">
              <div class="info-item">
                <span class="info-label">Images Ready:</span>
                <span class="info-value" id="process-count">0</span>
              </div>
              <div class="info-item">
                <span class="info-label">Output Format:</span>
                <span class="info-value">JPEG (High Quality)</span>
              </div>
              <div class="info-item">
                <span class="info-label">Download:</span>
                <span class="info-value">ZIP Archive</span>
              </div>
            </div>

            <button id="process-btn" class="btn btn-primary btn-lg" disabled style="position: relative;">
              <span class="btn-text"><i class="fas fa-magic"></i> Process &amp; Download</span>
              <div class="btn-loader" style="display: none;"><i class="fas fa-spinner fa-spin"></i></div>
            </button>

            <div id="download-section" class="download-section" style="display: none;">
              <div class="download-success">
                <i class="fas fa-check-circle"></i>
                <span>Processing Complete!</span>
              </div>
              <a id="download-link" href="#" class="btn btn-success btn-lg">
                <i class="fas fa-download"></i> Download Watermarked Images
              </a>
            </div>
          </div>
        </div>
      </div>

      <!-- ====== RIGHT PANEL â€” UNIFIED WATERMARK / ADJUST / PREVIEW ====== -->
      <div class="right-panel">
        <div class="card unified-card">
          <div class="card-header">
            <h3>
              <i class="fas fa-shield-alt"></i>
              <span class="step-label">Step 2:</span> Watermark &amp; Preview
            </h3>
            <div style="display: flex; gap: 6px; align-items: center;">
              <button class="btn btn-primary btn-sm" id="generate-preview">
                <i class="fas fa-play"></i> Preview
              </button>
              <button class="btn-icon" id="enlarge-preview" style="display: none;" title="Fullscreen">
                <i class="fas fa-expand"></i>
              </button>
            </div>
          </div>
          <div class="card-body">
            <div class="unified-sections">

              <!-- Section: Watermark Selection -->
              <div class="uni-section">
                <div class="uni-section-title">
                  <i class="fas fa-images"></i> Choose Watermark
                </div>
                <div class="wm-select-row">
                  <div class="wm-select-col">
                    <div class="select-wrapper">
                      <select id="watermark-select" class="custom-select"></select>
                      <i class="fas fa-chevron-down select-icon"></i>
                    </div>
                    <p class="wm-helper" id="wm-helper-text">Default: reverse-logo (white). ARMLS mode shows only approved logos.</p>
                  </div>
                  <div class="wm-preview-thumb" id="watermark-preview-container">
                    <img id="watermark-preview" src="" alt="Watermark Preview" style="display: none;">
                    <i class="fas fa-image wm-placeholder" id="watermark-placeholder"></i>
                  </div>
                </div>

                <!-- Custom upload (disabled in ARMLS) -->
                <div id="custom-upload-wrapper" style="margin-top: 12px;">
                  <button class="adv-toggle" id="advanced-toggle">
                    <i class="fas fa-chevron-down"></i> Custom Watermark Upload
                  </button>
                  <div id="advanced-watermark-section" class="adv-section" style="display: none;">
                    <div class="adv-warning">
                      <i class="fas fa-exclamation-triangle"></i>
                      <strong>Warning:</strong> Only upload custom watermarks you have permission to use for Fort Lowell Realty branded content.
                    </div>
                    <input type="file" id="watermark-upload" accept=".png,.jpg,.jpeg,.webp" hidden>
                    <button id="change-watermark" class="btn btn-secondary w-full">
                      <i class="fas fa-upload"></i> Upload Custom Watermark
                    </button>
                  </div>
                </div>
              </div>

              <!-- Section: Adjustments -->
              <div class="uni-section">
                <div class="uni-section-title">
                  <i class="fas fa-sliders-h"></i> Adjust Appearance
                </div>
                <div class="adj-grid">
                  <!-- Position -->
                  <div class="adj-item">
                    <div class="adj-label"><i class="fas fa-arrows-alt"></i> Default Position</div>
                    <div class="select-wrapper">
                      <select id="position-select" class="custom-select">
                        <option value="top-left">Top Left</option>
                        <option value="top-right">Top Right</option>
                        <option value="center" selected>Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                      <i class="fas fa-chevron-down select-icon"></i>
                    </div>
                  </div>
                  <!-- Opacity -->
                  <div class="adj-item">
                    <div class="adj-label">
                      <i class="fas fa-adjust"></i> Opacity
                      <span class="adj-value" id="opacity-value">40%</span>
                    </div>
                    <input type="range" id="opacity-slider" class="custom-slider" min="0" max="100" value="40">
                  </div>
                  <!-- Size -->
                  <div class="adj-item adj-full">
                    <div class="adj-label">
                      <i class="fas fa-expand-arrows-alt"></i> Size
                      <span class="adj-value" id="size-value">35%</span>
                    </div>
                    <input type="range" id="size-slider" class="custom-slider" min="5" max="80" value="35">
                  </div>
                </div>
              </div>

              <!-- Section: Live Preview -->
              <div class="uni-section preview-area">
                <div class="uni-section-title">
                  <i class="fas fa-eye"></i> Live Preview
                </div>
                <div class="preview-wrapper" id="preview-wrapper">
                  <canvas id="preview-canvas" style="display: none;"></canvas>
                  <div class="preview-placeholder" id="preview-placeholder">
                    <i class="fas fa-image"></i>
                    <h4>No Preview Yet</h4>
                    <p>Upload images &amp; click "Preview" above</p>
                  </div>
                  <div class="preview-loading" id="preview-loading" style="display: none;">
                    <i class="fas fa-spinner fa-spin"></i>
                    <h4>Generating...</h4>
                  </div>
                </div>

                <!-- Preview info bar -->
                <div class="preview-bar" id="preview-bar" style="display: none;">
                  <div class="preview-file-info">
                    <span class="preview-file-name" id="preview-file-name">sample.jpg</span>
                    <span class="placement-badge" id="placement-status">Default</span>
                  </div>
                  <div class="preview-nav">
                    <button class="preview-nav-btn" id="prev-image" title="Previous">
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <span class="preview-counter" id="preview-counter">1 / 1</span>
                    <button class="preview-nav-btn" id="next-image" title="Next">
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </div>
                </div>

                <!-- Preview actions -->
                <div class="preview-actions" id="preview-actions" style="display: none;">
                  <button class="btn btn-secondary btn-sm" id="reset-position">
                    <i class="fas fa-undo"></i> Reset to default
                  </button>
                  <span class="drag-hint">
                    <i class="fas fa-hand-pointer"></i> Click/drag on preview to place watermark for this image
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>
  </main>

  <!-- Fullscreen Preview Modal -->
  <div id="fullscreen-modal" class="fullscreen-modal">
    <div class="fullscreen-content">
      <button class="fullscreen-close" id="fullscreen-close" title="Close">
        <i class="fas fa-times"></i>
      </button>
      <button class="fullscreen-nav fullscreen-prev" id="fullscreen-prev" title="Previous">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="fullscreen-nav fullscreen-next" id="fullscreen-next" title="Next">
        <i class="fas fa-chevron-right"></i>
      </button>
      <canvas id="fullscreen-canvas"></canvas>
      <div class="fullscreen-info">
        <span id="fullscreen-filename">image.jpg</span>
        <span id="fullscreen-counter">1 / 1</span>
      </div>
    </div>
  </div>

  <!-- Help Modal -->
  <div id="help-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>
          <i class="fas fa-question-circle"></i>
          How to Use Watermark-It
        </h3>
        <button class="modal-close" id="close-help" title="Close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="help-steps">
          <div class="help-step">
            <div class="help-number">1</div>
            <div class="help-content">
              <h4>Upload Images</h4>
              <p>Drag &amp; drop property photos, upload files/ZIPs, or paste image URLs. Supports JPG, PNG, WebP, and HEIC formats. HEIC files are auto-converted to JPEG.</p>
            </div>
          </div>
          <div class="help-step">
            <div class="help-number">2</div>
            <div class="help-content">
              <h4>Select &amp; Adjust Watermark</h4>
              <p>Pick a watermark from the dropdown, adjust opacity, size, and default position. Click or drag directly on the preview to set a custom position per image.</p>
            </div>
          </div>
          <div class="help-step">
            <div class="help-number">3</div>
            <div class="help-content">
              <h4>Download</h4>
              <p>Process all images and download as a high-quality ZIP archive. All images are exported as JPEGs.</p>
            </div>
          </div>
        </div>
        <div class="help-tips">
          <h4><i class="fas fa-lightbulb"></i> Pro Tips</h4>
          <ul>
            <li><i class="fas fa-check"></i> HEIC files from iPhones are automatically converted to JPEG</li>
            <li><i class="fas fa-check"></i> Enable ARMLS mode for MLS compliance (corners only, no custom logos)</li>
            <li><i class="fas fa-check"></i> Click/drag on the preview to customize each image's watermark position</li>
            <li><i class="fas fa-check"></i> Default 40% opacity &amp; 35% size provide great visibility without overpowering</li>
            <li><i class="fas fa-check"></i> Use the fullscreen button for a detailed view of each watermarked image</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-brand">
        <img src="https://pfst.cf2.poecdn.net/base/image/57c851c04753092259d83d0a1aa34e2fd889c7218b50a338e6100dbf21ae922c?w=733&h=982"
             alt="Fort Lowell Realty Logo"
             class="footer-logo"
             loading="lazy">
        <div class="footer-info">
          <p>&copy; 2026 Watermark-It &bull; <strong>Fort Lowell Realty &amp; Property Management</strong></p>
        </div>
      </div>
      <div class="footer-links">
        <a href="https://github.com/flmcoder/watermark-it" class="footer-link" target="_blank" rel="noopener noreferrer">
          <i class="fab fa-github"></i> GitHub
        </a>
      </div>
    </div>
  </footer>

  <!-- App Script -->
  <script src="scripts/app.js"></script>
</body>
</html>
